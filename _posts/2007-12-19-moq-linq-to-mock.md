---
id: 38
title: 'Moq: Linq to Mock'
date: 2007-12-19T15:29:00+00:00
author: Merill Fernando
layout: post
guid: /post/2007/12/Moq-Linq-to-Mock.aspx
permalink: /2007/12/moq-linq-to-mock/
dsq_thread_id:
  - "78025594"
categories:
  - .NET
---
<p>Daniel Cazzulino just <a href="http://www.clariusconsulting.net/blogs/kzu/archive/2007/12/18/LinqtoMockMoqisborn.aspx">announced</a> the birth of <a href="http://code.google.com/p/moq/">Moq</a>, now this is mocking done right.</p><pre>&nbsp;</pre>
<p class="MsoNormal"><span style="font-size: 10pt; color: #880000; line-height: 115%"><font face="Courier New">// ShouldExpectCallWithArgument</font></span><span style="font-size: 10pt; color: black; line-height: 115%"><br></span><font face="Courier New"><span style="font-size: 10pt; color: #000088; line-height: 115%">var</span><span style="font-size: 10pt; color: black; line-height: 115%"> mock </span><span style="font-size: 10pt; color: #666600; line-height: 115%">=</span><span style="font-size: 10pt; color: black; line-height: 115%"> </span><span style="font-size: 10pt; color: #000088; line-height: 115%">new</span><span style="font-size: 10pt; color: black; line-height: 115%"> </span><span style="font-size: 10pt; color: #660066; line-height: 115%">Mock</span><span style="font-size: 10pt; color: #666600; line-height: 115%">&lt;</span><span style="font-size: 10pt; color: #660066; line-height: 115%">IFoo</span><span style="font-size: 10pt; color: #666600; line-height: 115%">&gt;();</span></font><span style="font-size: 10pt; color: black; line-height: 115%"><br><br><font face="Courier New">mock</font></span><font face="Courier New"><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">Expect</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: black; line-height: 115%">x </span><span style="font-size: 10pt; color: #666600; line-height: 115%">=&gt;</span><span style="font-size: 10pt; color: black; line-height: 115%"> x</span><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">DoInt</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: #006666; line-height: 115%">1</span><span style="font-size: 10pt; color: #666600; line-height: 115%">)).</span><span style="font-size: 10pt; color: #660066; line-height: 115%">Returns</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: #006666; line-height: 115%">11</span><span style="font-size: 10pt; color: #666600; line-height: 115%">);</span></font><span style="font-size: 10pt; color: black; line-height: 115%"><br><font face="Courier New">mock</font></span><font face="Courier New"><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">Expect</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: black; line-height: 115%">x </span><span style="font-size: 10pt; color: #666600; line-height: 115%">=&gt;</span><span style="font-size: 10pt; color: black; line-height: 115%"> x</span><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">DoInt</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: #006666; line-height: 115%">2</span><span style="font-size: 10pt; color: #666600; line-height: 115%">)).</span><span style="font-size: 10pt; color: #660066; line-height: 115%">Returns</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: #006666; line-height: 115%">22</span><span style="font-size: 10pt; color: #666600; line-height: 115%">);</span></font><span style="font-size: 10pt; color: black; line-height: 115%"><br><br></span><font face="Courier New"><span style="font-size: 10pt; color: #660066; line-height: 115%">Assert</span><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">AreEqual</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: #006666; line-height: 115%">11</span><span style="font-size: 10pt; color: #666600; line-height: 115%">,</span><span style="font-size: 10pt; color: black; line-height: 115%"> mock</span><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">Instance</span><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">DoInt</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: #006666; line-height: 115%">1</span><span style="font-size: 10pt; color: #666600; line-height: 115%">));</span></font><span style="font-size: 10pt; color: black; line-height: 115%"><br></span><font face="Courier New"><span style="font-size: 10pt; color: #660066; line-height: 115%">Assert</span><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">AreEqual</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: #006666; line-height: 115%">22</span><span style="font-size: 10pt; color: #666600; line-height: 115%">,</span><span style="font-size: 10pt; color: black; line-height: 115%"> mock</span><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">Instance</span><span style="font-size: 10pt; color: #666600; line-height: 115%">.</span><span style="font-size: 10pt; color: #660066; line-height: 115%">DoInt</span><span style="font-size: 10pt; color: #666600; line-height: 115%">(</span><span style="font-size: 10pt; color: #006666; line-height: 115%">2</span><span style="font-size: 10pt; color: #666600; line-height: 115%">));</span></font></p>
<p class="MsoNormal"><font face="Courier New"><span style="font-size: 10pt; color: #666600; line-height: 115%"></span></font>&nbsp;</p><font face="Courier New"><span style="font-size: 10pt; color: #666600; line-height: 115%"></span></font>
<p><font face="Courier New"><span style="font-size: 10pt; color: #666600; line-height: 115%"></span></font></p>
<p>Lambda is starting to make my mouth water.</p>